<p align="center">
  <img src="/.img/Screenshot_1.png" alt="image" width="640" height="360" />
</p>

# üß© –ö–æ—à—Ç–æ–≤–Ω–∏–π –±–µ–∫–∞–ø (Expensive Backup)
## **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** Reverse Engineering  
## **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Hard  

---

### **–û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è:**  
–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –æ–¥–∏–Ω —ñ–∑ —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ –≤–∑—è–≤ —Ç—Ä–∏–≤–∞–ª—É –≤—ñ–¥–ø—É—Å—Ç–∫—É, –π–æ–≥–æ –∫–æ–ª–µ–≥–∏ –≤–∏—è–≤–∏–ª–∏ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏–π –ø—Ä–æ—Ü–µ—Å, —è–∫–∏–π –ø–æ–≤–∏–Ω–µ–Ω –±—É–≤ —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó —Ñ–∞–π–ª—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ ‚Äî –∞–ª–µ –∑–∞–º—ñ—Å—Ç—å –∞—Ä—Ö—ñ–≤—ñ–≤ –Ω–∞ –¥–∏—Å–∫—É –∑‚Äô—è–≤–ª—è–ª–∏—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ .enc-—Ñ–∞–π–ª–∏ —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –≤–∏–º–æ–≥–∞–º–∏ –≤–∏–∫—É–ø—É.  
–§–∞–π–ª, —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —Ç–∞ –æ–¥–∏–Ω —ñ–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –∑–º–æ–≥–ª–∏ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –∑ —Å–µ—Ä–≤–µ—Ä—É.  
–ó‚Äô—è—Å—É–π—Ç–µ, —è–∫ —Å–∞–º–µ –ø—Ä–∞—Ü—é—î –ø—Ä–æ–≥—Ä–∞–º–∞, —Ç–∞ –ø–æ–≤–µ—Ä–Ω—ñ—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

---
### **–§–∞–π–ª–∏**
```
Expensive_Backup.zip
‚îú‚îÄ‚îÄ flag.enc
‚îú‚îÄ‚îÄ README.txt
‚îú‚îÄ‚îÄ zip_password.txt
‚îî‚îÄ‚îÄ malware.zip
    ‚îî‚îÄ‚îÄ malware
```
### **–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è:**  
1. –°–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ—á–∏—Ç–∞—î–º–æ `README.txt`:
  
  ```
	Your file was encrypted!
	Send 1 BTC to this wallet: [Deleted]
	In comment write your ID_1 and ID_2
	ID1 = 55817cbbe921f8016f19d1201533f8cf4628548ba169d5be81abde640f499909
	ID2 = 2edb8f847d627e2d899893bc83ac1b5164943e79ba74dd8e4386146d2e4ed984
  ```
  
2. –ë–∞—á–∏–º–æ –¥–æ—Å–∏—Ç—å —Ç–∏–ø—ñ—á–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —ñ–∑ –≤–∏–º–æ–≥–∞–º–∏ –≤–∏–∫—É–ø—É.  
	–ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ –∞–Ω–∞–ª—ñ–∑—É –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É, –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ `strings`.
  
	<p align="center">
		<img src=".img/Screenshot_2.png" alt="strings output" />
	</p>
  
3. –£ —Ä—è–¥–∫–∞—Ö —Ñ–∞–π–ª—É –±–∞—á–∏–º–æ –æ–∑–Ω–∞–∫–∏ —Ç–æ–≥–æ, —â–æ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π —Ñ–∞–π–ª –±—É–≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ **Python 3.13**.  
	–í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ **pyinstxtractor**, —â–æ–± –≤–∏—Ç—è–≥–Ω—É—Ç–∏ `.pyc` —Ñ–∞–π–ª, –∞ –ø–æ—Ç—ñ–º –¥–µ–∫–æ–º–ø—ñ–ª—é—î–º–æ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [pylingual.io](https://pylingual.io).

	<p align="center">
		<img src=".img/Screenshot_3.png" alt="pyinstxtractor output" />
	</p>

	<p align="center">
		<img src=".img/Screenshot_4.png" alt="pylingual output" />
	</p>
  
4. –ü—ñ—Å–ª—è –¥–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó –±–∞—á–∏–º–æ, —â–æ –∫–æ–¥ –æ–±—Ñ—É—Å–∫–æ–≤–∞–Ω–∏–π.  
	–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤—à–∏, —è–∫ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—è, —Å–∫–ª–∞–¥–∞—î–º–æ –æ–±–µ—Ä–Ω–µ–Ω–∏–π –ª–∞–Ω—Ü—é–≥ –¥—ñ–π:

	- —Ä–µ–≤–µ—Ä—Å —Ä—è–¥–∫–∞  
	- base64 –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è  
	- zlib —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è
  
5. –í–∏–∫–æ–Ω–∞—î–º–æ —Ü—ñ –¥—ñ—ó –≤ [CyberChef](https://gchq.github.io/CyberChef/).

	<p align="center">
		<img src=".img/Screenshot_5.png" alt="CyberChef step 1" />
	</p>
  
6. –ë–∞—á–∏–º–æ, —â–æ —î —â–µ –æ–¥–∏–Ω —à–∞—Ä –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó.  
	–ü–æ–≤—Ç–æ—Ä—é—î–º–æ —Ç—ñ –∂ —Å–∞–º—ñ –¥—ñ—ó, –ø–æ–∫–∏ –Ω–µ –æ—Ç—Ä–∏–º–∞—î–º–æ –∫–æ–¥.

	<p align="center">
		<img src=".img/Screenshot_6.png" alt="CyberChef step 2" />
	</p>
  
7. –ü—ñ—Å–ª—è –∫—ñ–ª—å–∫–æ—Ö —ñ—Ç–µ—Ä–∞—Ü—ñ–π –æ—Ç—Ä–∏–º–∞—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.

  ```python
  from Crypto.Util.number import getPrime, inverse, bytes_to_long, long_to_bytes
  import os
  
  def generate_rsa(bits=128):
      p = getPrime(bits)
      q = getPrime(bits)
      n = p * q
      phi = (p - 1) * (q - 1)
      e = 65537
      return n, e, p, q
  
  def rsa_encrypt(data, e, n):
      return long_to_bytes(pow(bytes_to_long(data), e, n))
  
  def xor_encrypt(data, key):
      return bytes([b ^ key[i % len(key)] for i, b in enumerate(data)])
  
  n, e, p, q = generate_rsa()
  
  xor_key = os.urandom(8)
  xor_key_enc = rsa_encrypt(xor_key, e, n)
  
  try:
      with open("flag.txt", "rb") as f:
          flag = f.read()
  except FileNotFoundError:
      print("flag.txt NOT FOUND")
      exit(1)
  
  encrypted_flag = xor_encrypt(flag, xor_key)
  
  with open("flag.enc", "wb") as f:
      f.write(encrypted_flag)
  
  os.remove("flag.txt")
  
  with open("README.txt", "w") as f:
      f.write(f"""Your file was encrypted!
  Send 1 BTC to this wallet: [Deleted]
  In comment write your ID_1 and ID_2
  ID1 = {long_to_bytes(n).hex()}
  ID2 = {xor_key_enc.hex()}
  """)
  ```
  –°–ø–æ—á–∞—Ç–∫—É –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –≤–∏–ø–∞–¥–∫–æ–≤–∏–π **XOR-–∫–ª—é—á** –¥–æ–≤–∂–∏–Ω–æ—é 8 –±–∞–π—Ç.  
  –¶–µ–π –∫–ª—é—á –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª—É (—É –¥–∞–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É ‚Äî **flag.txt**) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–ø–µ—Ä–∞—Ü—ñ—ó **–ø–æ–±—ñ—Ç–æ–≤–æ–≥–æ XOR**.

  –©–æ–± –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ XOR-–∫–ª—é—á, –π–æ–≥–æ —Ç–∞–∫–æ–∂ —à–∏—Ñ—Ä—É—é—Ç—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∞–ª–≥–æ—Ä–∏—Ç–º—É **RSA**.  
  –î–ª—è —Ü—å–æ–≥–æ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –¥–≤–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –ø—Ä–æ—Å—Ç–∏—Ö —á–∏—Å–ª–∞ –ø–æ 128 –±—ñ—Ç, —è–∫—ñ –ø–µ—Ä–µ–º–Ω–æ–∂—É—é—Ç—å—Å—è, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –º–æ–¥—É–ª—å `n = p √ó q`.  
  –í—ñ–¥–∫—Ä–∏—Ç–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫ `e` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º **65537**.  
  –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ XOR-–∫–ª—é—á —à–∏—Ñ—Ä—É—î—Ç—å—Å—è RSA —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ **README.txt**.
  
  –î–∞–ª—ñ —Ñ–∞–π–ª **flag.txt** —à–∏—Ñ—Ä—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é XOR-–∫–ª—é—á–∞, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∞ –≤–µ—Ä—Å—ñ—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —è–∫ **flag.enc**, –∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è.
  
  –£ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ —É —Ñ–∞–π–ª—ñ **README.txt** –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–Ω—è:
  
  - **ID1** ‚Äî —Ü–µ –º–æ–¥—É–ª—å `n` —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ (–ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è —Ä–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è RSA)
  - **ID2** ‚Äî XOR-–∫–ª—é—á, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π RSA (—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç)

  –°–ª–∞–±–∫—ñ—Å—Ç—å –∫–æ–¥—É –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞.  
	–î–ª—è –π–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–µ–ª–∏–∫—ñ –ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞, —Ç–æ–º—É –º–∏ –º–æ–∂–µ–º–æ —Ñ–∞–∫—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á, –∑–Ω–∞–π—Ç–∏ `p` —Ç–∞ `q` —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á `d`.
  
8. –ú—ñ–π –≤–∞—Ä—ñ–∞–Ω—Ç –∫–æ–¥—É –¥–ª—è –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:
  ```python
  from Crypto.Util.number import inverse, bytes_to_long, long_to_bytes

  rsa_pub = int("55817cbbe921f8016f19d1201533f8cf4628548ba169d5be81abde640f499909", 16)
  xor_enc = int("2edb8f847d627e2d899893bc83ac1b5164943e79ba74dd8e4386146d2e4ed984", 16)
  
  print(rsa_pub)
  
  p = int(input())
  q = int(input())
  phi = (p - 1) * (q - 1)
  e = 65537
  d = inverse(e, phi)
  
  xor_key = long_to_bytes(pow(xor_enc, d, rsa_pub))
  with open('flag.enc', 'rb') as f:
    flag_enc = f.read()
  
  flag = bytes([b ^ xor_key[i % len(xor_key)] for i, b in enumerate(flag_enc)])
  print(flag)
  ```
  <p align="center">
	<img src=".img/Screenshot_7.png" alt="decrypt output" />
  </p>
  	
   –ó —Ñ–∞–π–ª—É `README.txt` —è –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∏–≤ `rsa_pub` (ID1) —Ç–∞ `xor_enc` (ID2). –°–∫—Ä–∏–ø—Ç –≤–∏–≤–µ–¥–µ `rsa_pub` —É –≤–∏–≥–ª—è–¥—ñ —á–∏—Å–ª–∞. –î–∞–ª—ñ —Å–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ—Å—è [yafu]https://github.com/bbuhrow/yafu) –¥–ª—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó: `yafu-x64.exe factor(—á–∏—Å–ª–æ)`
  <p align="center">
	<img src=".img/Screenshot_8.png" alt="YAFU factorization" />
</p>
  
9. –ü—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ —É —Å–∫—Ä–∏–ø—Ç –æ—Ç—Ä–∏–º–∞—î–º–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–ª–∞–≥.

	<p align="center">
		<img src=".img/Screenshot_9.png" alt="Decryption output" />
	</p>

---
#### **Flag:** ```actf{pyrev_flag_x7H!9x&P9c}```
---
