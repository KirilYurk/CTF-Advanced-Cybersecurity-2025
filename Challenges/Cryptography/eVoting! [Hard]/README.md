<p align="center">
  <img src="/.img/Screenshot_1.png" alt="image" width="640" height="360" />
</p>

# üß© —î–ì–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è! (eVoting!)
## **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** Cryptography  
## **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Hard

---

### **–û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è:**  
–í —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç—ñ —Å—Ç–≤–æ—Ä–∏–ª–∏ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –≥–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è.  
–î–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –ø—Ä–æ–∑–æ—Ä–æ—Å—Ç—ñ —Ç–∞ –¥–æ–≤—ñ—Ä–∏, –∫–æ–∂–µ–Ω –≥–æ–ª–æ—Å —à–∏—Ñ—Ä—É—î—Ç—å—Å—è –æ–¥—Ä–∞–∑—É –¥–ª—è —á–æ—Ç–∏—Ä—å–æ—Ö —á–ª–µ–Ω—ñ–≤ –∂—É—Ä—ñ, —É –∫–æ–∂–Ω–æ–≥–æ –∑ —è–∫–∏—Ö —î –≤–ª–∞—Å–Ω–∏–π –ø–æ—Å—Ç—ñ–π–Ω–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á.  
–í—Å—ñ –ø—É–±–ª—ñ—á–Ω—ñ –∫–ª—é—á—ñ –≤—ñ–¥–∫—Ä–∏—Ç–æ –ø—É–±–ª—ñ–∫—É—é—Ç—å—Å—è, –∞–±–∏ –±—É–¥—å-—Ö—Ç–æ –º—ñ–≥ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ –æ–±—Ä–æ–±–∫–∏ –≥–æ–ª–æ—Å—ñ–≤.  
–£ —Ç–µ—Å—Ç–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–ª–∞ —Ñ–ª–∞–≥ —è–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

---
### **–§–∞–π–ª–∏**
```
e-vote.zip
‚îú‚îÄ‚îÄ e-vote.py
‚îú‚îÄ‚îÄ –ë—é–ª–µ—Ç–µ–Ω—å 1.vote
‚îú‚îÄ‚îÄ –ë—é–ª–µ—Ç–µ–Ω—å 2.vote
‚îú‚îÄ‚îÄ –ë—é–ª–µ—Ç–µ–Ω—å 3.vote
‚îî‚îÄ‚îÄ –ë—é–ª–µ—Ç–µ–Ω—å 4.vote
```
### **–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è:**  
**–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è:**

1. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É—î–º–æ –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–∏:

    ```python
    #e-vote.py
    from Crypto.Util.number import bytes_to_long, long_to_bytes
    public_keys = [
    101540196203343039193237363887298737065527741074753109601420266985015023027559464289486174652201705157594005316897576053024695971502509955631612697314064019878196402624419019295057597912285186714346024774384219885965101915073767080144699620476030452048478052943647817215002893305863457341602453334333692903441,
    168926806431095974108156359951867848313600777357231327514161176715858443178915477990511125524172557170759668267002156781989485693234711683465652691578720626323133760355427968865848263032886779565796591499165912592061954725656004196938225976601361455490470892857429650976945258219876391274925558625896859015987,
    131441791876622652108066990882773699345420438549661918194633578026212036801397331432524916701884390292615642604154195686150663298337969945514457028502746505876639971822596713199894347359602915128461755613102411524779044354433322540733517548147925495312457176328432914811150311491919654577464969028513638255441,
    125086666808980339093873101066093359885547318159021318417451930062985035824855255502125098369664752135985093060033273907787214924385501542748233036479339745684585715218089699441845588406096291395854265339287698999371030275278136803055531512467459409071480305271919058112831542250356581610175467195135057230021,
    ]

    e = 3

    vote = b"Choosen candidate: actf{example_flag}"
    
    m = bytes_to_long(vote)
    
    for i, n in enumerate(public_keys, 1):
        vote_enc = pow(m, e, n)
        with open(f"–ë—é–ª–µ—Ç–µ–Ω—å {i}.vote", 'wb') as file:
            file.write(long_to_bytes(vote_enc))
    ```

2. –¶—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ö–∏–ª—å–Ω–∞ –¥–æ **Broadcast attack** –Ω–∞ RSA, –æ—Å–∫—ñ–ª—å–∫–∏ –º–∞—î –º–∞–ª–µ–Ω—å–∫—É –µ–∫—Å–ø–æ–Ω–µ–Ω—Ç—É.  
   –ù–∞–ø–∏—à–µ–º–æ –Ω–µ–≤–µ–ª–∏–∫–∏–π —Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –∑—á–∏—Ç—É—î —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∏ –∑ —Ñ–∞–π–ª—ñ–≤ —Ç–∞ –≥–æ—Ç—É—î –¥–∞–Ω—ñ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É:

    ```python
    #from Crypto.Util.number import bytes_to_long, long_to_bytes

    print("Ciphertexts:")
    for i in range(1,4):
        with open(f"–ë—é–ª–µ—Ç–µ–Ω—å {i}.vote", "rb") as f:
            print(bytes_to_long(f.read()))
    
    print(long_to_bytes(int(input("m="))).decode())

    ```

3. –î–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Å–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ—Å—å –æ–Ω–ª–∞–π–Ω-—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º [RSA Calculator](https://www.tausquared.net/pages/ctf/rsa.html).  
   –í—Å—Ç–∞–≤–ª—è—î–º–æ –ø—É–±–ª—ñ—á–Ω—ñ –∫–ª—é—á—ñ —Ç–∞ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∏, –ø—ñ—Å–ª—è —á–æ–≥–æ –ø–æ —á–µ—Ä–∑—ñ –Ω–∞—Ç–∏—Å–∫–∞—î–º–æ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω—å:

    <p align="center">
      <img width="412" height="431" alt="image" src=".img/Screenshot_1.png" />
    </p>

4. –Ø–∫ –±–∞—á–∏–º–æ, —Å–∏—Å—Ç–µ–º–∞ –¥—ñ–π—Å–Ω–æ –≤—Ä–∞–∑–ª–∏–≤–∞ –¥–æ –∞—Ç–∞–∫–∏. –û—Ç—Ä–∏–º—É—î–º–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:

    <p align="center">
      <img width="372" height="148" alt="image" src=".img/Screenshot_2.png" />
    </p>

5. –í—Å—Ç–∞–≤–ª—è—î–º–æ –æ—Ç—Ä–∏–º–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è `m` —É —Å–∫—Ä–∏–ø—Ç —Ç–∞ –æ—Ç—Ä–∏–º—É—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

    <p align="center">
      <img width="582" height="85" alt="image" src=".img/Screenshot_3.png" />
    </p>


---
#### **Flag:** ```actf{e-voting_flaw_pDn7@6}```  
